<!DOCTYPE html>
<html lang="en">
<head>
    <title>Patterns in the Void - hacking</title>
    <meta charset="utf-8" />
    <meta name="robots" 
          content="noindex, nofollow">
    <link rel="stylesheet" 
          href="../theme/css/main.css" 
          type="text/css" />
        <link href="https://blog.patternsinthevoid.net/feeds/all.atom.xml" 
          type="application/atom+xml" 
          rel="alternate" 
          title="Patterns in the Void Atom Feed" />
                <link href="../theme/prettify/prettify.css"
          type="text/css"
          rel="stylesheet" />
    <script type="text/javascript" 
            src="../theme/prettify/prettify.js"></script>
        <noscript>
        <div style="width:80%;">
        <p style="line-height:90%;margin:10px 10px 0px 10px;text-align:justify;text-indent:25px;">
            <small>
            <br>Hey, kudos! You don't run arbitrary scripts either!<br />
            <br>My apologies for the javascript on this page...it's 
            prettify.js for the syntax highlighting in code blocks. 
            I added
            <a href="../theme/prettify/nope.css">one line of CSS</a>
            for you; the rest of this site should work fine.<br />
            <br>&#x24B6;&#38;&#x2665; isis<br /></small>
        </p>
        </div>
        <link href="../theme/prettify/nope.css"
              type="text/css"
              rel="stylesheet" />
    </noscript>

    <!--[if IE]>
        <script src="../theme/js/html5.js">
        </script>
        <![endif]-->

    <!--[if lte IE 7]>
        <link rel="stylesheet" type="text/css" media="all"
              href="../theme/css/ie.css"/>
        <script src="../theme/js/IE8.js"
                type="text/javascript"></script>
        <![endif]-->

    <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" media="all"
              href="../theme/css/ie6.css"/>
        <![endif]-->
</head>

<body id="index" class="home" onload="prettyPrint()">
<a href="https://github.com/isislovecruft">
        <img style="position: absolute; top: 0; right: 0; border: 0; max-width: 48px;"
         src="https://blog.patternsinthevoid.net/theme/images/icons/github-tentacle-icon.png"
         alt="code." />
</a>
<header id="banner" class="body">
    <h1>
        <a href="../">Patterns in the Void 
                    </a>
    </h1>
    <nav>
        <ul>
                                                                                    <li >
                <a href="../category/anarchism.html">anarchism</a>
            </li>
                                                                        <li class="active">
                <a href="../category/hacking.html">hacking</a>
            </li>
                                                <li >
                <a href="../category/physics.html">physics</a>
            </li>
                                                <li >
                <a href="../category/travel.html">travel</a>
            </li>
                                </ul>
    </nav>
</header>

<!-- /#banner -->
        
        

 
                <ul>
                        <li class="tag-1"><a href="/tag/cryptography/">cryptography</a></li>
                        <li class="tag-1"><a href="/tag/artificial intelligence/">artificial intelligence</a></li>
                        <li class="tag-3"><a href="/tag/anarchism/">anarchism</a></li>
                        <li class="tag-1"><a href="/tag/python/">python</a></li>
                        <li class="tag-2"><a href="/tag/linux/">linux</a></li>
                        <li class="tag-2"><a href="/tag/quantum physics/">quantum physics</a></li>
                        <li class="tag-1"><a href="/tag/hacking/">hacking</a></li>
                        <li class="tag-1"><a href="/tag/Tor/">Tor</a></li>
                        <li class="tag-2"><a href="/tag/crypto-anarchism/">crypto-anarchism</a></li>
                        <li class="tag-3"><a href="/tag/Defcon/">Defcon</a></li>
                    </ul>
        <section id="content" class="body">
            <ol id="posts-list" class="hfeed" start="2">
                                <li>
                    <article class="hentry">    
                        <header>
                            <h1>
                                <a href="../progress-problems-tmux-for-android.html" 
                                   rel="bookmark"
                                   title="Permalink to Progress & Problems: Tmux forÂ Android">Progress <span class="amp">&amp;</span> Problems: Tmux for&nbsp;Android</a></h1>
                        </header>
                
                        <div class="entry-content">
                            <footer class="post-info">
        <abbr class="published" title="2011-12-27T14:03:00">
                Tuesday, 27 December 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/isis-agora-lovecruft.html">isis agora lovecruft</a>
        </address>
        <p>In <a href="../category/hacking.html">hacking</a> </p>
<p>tags: <a href="../tag/28c3.html">28c3 </a><a href="../tag/android.html">android </a><a href="../tag/android-ndk.html">android ndk </a><a href="../tag/arm.html">ARM </a><a href="../tag/c.html">C </a><a href="../tag/chaos-computer-club.html">Chaos Computer Club </a><a href="../tag/cyanogen.html">cyanogen </a><a href="../tag/hacking.html">hacking </a><a href="../tag/java.html">java </a><a href="../tag/linux.html">linux </a><a href="../tag/perl.html">perl </a><a href="../tag/tmux.html">tmux </a><a href="../tag/ubuntu.html">ubuntu </a></p>
</footer><!-- /.post-info -->                            <p>One of the things I need for <a href="http://www.patternsinthevoid.net/blog/2011/12/xqdr-a-flying-robot-that-does-things/" title="xqdr: A Flying Robot That Does Things">xqdr</a>, the flying robot that I&#8217;m
building, is a terminal multiplexer, like <a href="http://en.wikipedia.org/wiki/GNU_Screen">screen</a> or <a href="http://tmux.sourceforge.net/">tmux</a>. I use
tmux, personally, and jeepers wouldn&#8217;t it be neat to have it run
natively on my phone so that I don&#8217;t have to use ConnectBot to an
outside server and then do &#8220;tmux&nbsp;attach&#8221;?</p>
<p>Fortunately (or so I thought when starting this project), tmux is
written entirely in C. This turned out to be difficult, and so I&#8217;ll
outline how I did&nbsp;it.</p>
<p>The Android kernel uses a slimmed down version of standard C libraries
(libc.so), called bionic. This is where all the allowed calls are
stored. It&#8217;s possible to&nbsp;either:</p>
<p>Surprisingly, I attempted the second option first. <em>This was insane.</em> I
had to <a href="https://gist.github.com/1518816">compile a compiler to compile a compiler to compile a
compiler</a> to <a href="http://plausible.org/andy/agcc">compile a shared object library through a perl
wrapper</a> to compile the code. I think I made it through all the
compiling compilers parts, and then my <a href="https://github.com/jsnyder/arm-eabi-toolchain">finished compiler</a> crapped all
over its&nbsp;pants.</p>
<p>It was at this point that I decided to check my phone, and I realised
that CyanogenMod7 already has a shared object library for standard C.
(It&#8217;s at /system/lib/libc.so). There is the possibility that I could use
this pre-<span class="caps">ARM</span>-compiled library, bundle it with tmux, and then use
<a href="http://developer.android.com/sdk/ndk/index.html">Android</a> <a href="http://mindtherobot.com/blog/452/android-beginners-ndk-setup-step-by-step/"><span class="caps">NDK</span></a> to compile tmux for <span class="caps">ARM</span>. This would also necessitate
creating a .<span class="caps">JNI</span> makefile for the frontend ...</p>
                            <a class="readmore" href="../progress-problems-tmux-for-android.html">read more</a>
                                                    </div><!-- /.entry-content -->
                </article>
                </li>
                                                

 
                        <li>
                    <article class="hentry">    
                        <header>
                            <h1>
                                <a href="../disassembly.html" 
                                   rel="bookmark"
                                   title="Permalink to Disassembly">Disassembly</a></h1>
                        </header>
                
                        <div class="entry-content">
                            <footer class="post-info">
        <abbr class="published" title="2011-12-20T17:58:00">
                Tuesday, 20 December 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/isis-agora-lovecruft.html">isis agora lovecruft</a>
        </address>
        <p>In <a href="../category/hacking.html">hacking</a> </p>
<p>tags: <a href="../tag/assembly-languages.html">assembly languages </a><a href="../tag/exploit-development.html">exploit development </a><a href="../tag/fancy-punks.html">fancy punks </a><a href="../tag/hex.html">hex </a><a href="../tag/linux.html">linux </a><a href="../tag/shellcode.html">shellcode </a></p>
</footer><!-- /.post-info -->                            <p>Often when doing exploit development, it&#8217;s <a href="http://www.patternsinthevoid.net/blog/2011/09/learning-assembly-through-writing-shellcode/" title="Learning Assembly Through Writing Shellcode">necessary to extract hex
opcodes</a> from an assembly or C program to generate shellcode.
Normally, to do this, one uses <strong>objdump</strong> as in the following&nbsp;example:</p>
<p><code>isis agora lovecruft@wintermute:~$ cat shellcode.asm</code></p>
<p>section&nbsp;.text</p>
<p>global&nbsp;_start</p>
<p>_start:</p>
<p>;; setreuid&nbsp;(0,0)</p>
<p>xor eax, eax ;clear the eax&nbsp;registry</p>
<p>mov al, 0x46 ;set the syscall # to decimal 70 or hex 46, one&nbsp;byte</p>
<p>xor ebx,&nbsp;ebx</p>
<p>xor ecx,&nbsp;ecx</p>
<p>int 0x80 ;system interrupt to call kernel to execute&nbsp;syscall</p>
<p>;; spawn shellcode with&nbsp;execve</p>
<p>xor eax,&nbsp;eax</p>
<p>push eax ;push a <span class="caps">NULL</span> value on the&nbsp;stack</p>
<p>push 0x68732f2f ;push &#8216;//sh&#8217; onto the&nbsp;stack</p>
<p>push 0x6369622f ;push &#8216;/bin&#8217; onto the&nbsp;stack</p>
<p>mov ebx, esp ;esp now points to &#8216;/bin/sh&#8217;, so write to&nbsp;ebx</p>
<p>push eax ;push another <span class="caps">NULL</span> to terminate char ** argv on&nbsp;stack</p>
<p>push ebx ;push pointer to &#8216;/bin/sh&#8217; onto&nbsp;stack</p>
<p>mov ecx, esp ;esp now holds the address of argv, so write to&nbsp;ecx</p>
<p>xor edx,&nbsp;edx</p>
<p>mov al, 0xb ;set the syscall # to decimal 11 or hex b, one&nbsp;byte</p>
<p>int 0x80 ;sytem interrupt to call kernel to execute&nbsp;syscall</p>
<p>isis agora lovecruft@wintermute:\~\$ nasm -f elf&nbsp;shellcode.asm</p>
<p>isis agora lovecruft@wintermute:\~\$ ld -melf_i386 -o shellcode&nbsp;shellcode.o</p>
<p>isis agora lovecruft@wintermute:\~\$ objdump -d&nbsp;./shellcode</p>
<p>./shellcode: file format&nbsp;elf32-i386</p>
<p>Disassembly of section&nbsp;.text:</p>
<p>08048060 \&lt;_start>:</p>
<p>8048060: 31 c0 xor&nbsp;%eax,%eax</p>
<p>8048062: b0 46 mov&nbsp;\$0x46,%al</p>
<p>8048064: 31 db xor&nbsp;%ebx,%ebx</p>
<p>8048066: 31 c9 xor&nbsp;%ecx,%ecx</p>
<p>8048068 ...</p>
                            <a class="readmore" href="../disassembly.html">read more</a>
                                                    </div><!-- /.entry-content -->
                </article>
                </li>
                                                

 
                        <li>
                    <article class="hentry">    
                        <header>
                            <h1>
                                <a href="../automated-bandwidth-efficient-and-encrypted-backups.html" 
                                   rel="bookmark"
                                   title="Permalink to Automated, Bandwidth-Efficient, and EncryptedÂ Backups">Automated, Bandwidth-Efficient, and Encrypted&nbsp;Backups</a></h1>
                        </header>
                
                        <div class="entry-content">
                            <footer class="post-info">
        <abbr class="published" title="2011-12-19T19:29:00">
                Monday, 19 December 2011
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/isis-agora-lovecruft.html">isis agora lovecruft</a>
        </address>
        <p>In <a href="../category/hacking.html">hacking</a> </p>
<p>tags: <a href="../tag/backup.html">backup </a><a href="../tag/bash-scripting.html">bash scripting </a><a href="../tag/command-line.html">command line </a><a href="../tag/cryptography.html">cryptography </a><a href="../tag/duplicity.html">duplicity </a><a href="../tag/linux.html">linux </a></p>
</footer><!-- /.post-info -->                            <p>I made a bash shell script to automate encrypted (remote or local) data
backups with <a href="http://duplicity.nongnu.org/" title="Duplicity">Duplicity</a>. Duplicity uses asymmetric <span class="caps">GPG</span> <span class="caps">RSA</span> keys to
encrypt a tarballs of specified files to be backed up, and it also
supports incremental backups. So, after making a full backup, it is more
efficient do to the fact that it only saves changes made to files and
not entirely new copies of files. Duplicity also supports versioning,
i.e. you can say &#8220;give me File A from 3 days&nbsp;ago&#8221;.</p>
<p>Duplicity is <em>not</em> efficient in it&#8217;s cryptographic design, as my friend
Tom wisely pointed out, in that use of asymmetric cryptographic
algorithms is heavily intensive upon processor resources, and it would
be better to replace this feature with something more along the lines of
the algorithms (e.g. <span class="caps">AES</span>, Serpent, and Twofish) and read/write speed
testing features which <a href="http://www.truecrypt.org/" title="TrueCrypt">TrueCrypt</a> supports, for&nbsp;example.</p>
<p>This script depends on both curl and a newer version of duplicity (which
is not yet included in the standard repositories), so to install those
dependencies in Ubuntu&nbsp;do:</p>
<p><code>$ sudo apt-add-repository ppa:duplicity-team/ppa</code></p>
<p>\$ sudo apt-get&nbsp;update</p>
<p>\$ sudo apt-get install duplicity&nbsp;curl</p>
<p>Here&#8217;s version 0.1.2 of the backup script [(or view it on github&nbsp;here)][]:</p>
<p>#!/bin/bash</p>
<p>#&nbsp;_____________________</p>
<p>#| <span class="caps">BACKUP</span>[your].<span class="caps">SH</span>[it]&nbsp;|</p>
<p>#|&#8211;&#8211;&#8211;&#8211;&#8211;&#8211;&#8211;|</p>
<p>#|v.0.1.2 |\ \^&nbsp;/\^</p>
<p>#|Written by | \ / \ //&nbsp;\  </p>
<p>#|isis agora lovecruft Lovecruft | \ |\___/| / \//&nbsp;.\  </p>
<p>#|isis agora lovecruft@patternsinthe | \ /O O \__ / // | \ \&nbsp;*&#8211;-*</p>
<p>#| void.net| / / \/_/ // | \ \ \&nbsp;|</p>
<p>#|_____________________| @___@` \/_ // | \  
\ \/\&nbsp;\  </p>
<p># 0/0/| \/_ // | \ \ \&nbsp;\  </p>
<p># 0/0/0/0/| \/// | \ \ |&nbsp;|</p>
<p># 0/0/0/0/0 ...</p>
                            <a class="readmore" href="../automated-bandwidth-efficient-and-encrypted-backups.html">read more</a>
                                                    </div><!-- /.entry-content -->
                </article>
                </li>
                                            </ol><!-- /#posts-list -->
                        <p class="paginator">
                        <a href="../category/hacking2.html">&laquo;</a>
                Page 3 / 14
            <a href="../category/hacking4.html">&raquo;</a>
    </p>
                    </section><!-- /#content -->
                                <section id="extras" 
         class="body">
        <div class="blogroll">
        <h2>blogroll</h2>
        <ul>
                        <li><a href="https://fyb.patternsinthevoid.net">main</a></li>
                        <li><a href="https://blog.patternsinthevoid.net/isis.txt">keys</a></li>
                        <li><a href="https://code.patternsinthevoid.net">code</a></li>
                        <li><a href="https://blog.patternsinthevoid.net/calendar.html">time</a></li>
                        <li><a href="https://blog.patternsinthevoid.net/about.html">about</a></li>
                    </ul>
    </div>
    <!-- /.blogroll -->
            <div class="social">
        <h2>social</h2>
        <ul>
            <li><a href="https://blog.patternsinthevoid.net/feeds/all.atom.xml" 
                   type="application/atom+xml" 
                   rel="alternate">atom feed</a>
            </li>
                        
                        <li><a href="https://twitter.com/#!/isislovecruft">Twitter</a></li>
                        <li><a href="https://github.com/isislovecruft">Github</a></li>
                    </ul>
    </div><!-- /.social -->
    </section><!-- /#extras -->
<footer id="contentinfo" class="body" position="relative">
    <div style="height: 100%">
        <address id="about">
                <iframe src="//crypto.stanford.edu/flashproxy/embed.html" 
        width="80" height="15"
        frameborder="0" scrolling="no"
        accesskey="i"
        display="none"
        groove>
</iframe>
<div id="over">You're currently helping people in censored regions with <a href="https://crypto.stanford.edu/flashproxy/options.html">FlashProxy</a>. Thanks!</div>                </address><!-- /#about -->
    </div>
</footer><!-- /#contentinfo -->
</body>
</html>